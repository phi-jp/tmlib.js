<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*
 * eventdispatcher.js
 */

tm.event = tm.event || {};

(function() {
    
<span id='tm-event-EventDispatcher'>    /**
</span>     * @class tm.event.EventDispatcher
     * Event Dispatcher
     * ### Reference
     * -(EventDispatcher - ActionScript 3.0 コンポーネントリファレンスガイド)[http://livedocs.adobe.com/flash/9.0_jp/ActionScriptLangRefV3/flash/events/EventDispatcher.html]
     */
<span id='tm-event-EventDispatcher-method-constructor'>    tm.event.EventDispatcher = tm.createClass({
</span>
        /**
         * @constructor
         * コンストラクタ
         */
        init: function() {
<span id='tm-event-EventDispatcher-property-on'>            this._listeners = {};
</span>        },

        /**
         * @property
         * イベントリスナー追加(addEventListenerと同様)
         */
        on: function(type, listener) {
            if (this._listeners[type] === undefined) {
                this._listeners[type] = [];
            }
            
<span id='tm-event-EventDispatcher-property-addEventListener'>            this._listeners[type].push(listener);
</span>            return this;
        },
        
        /**
         * @property
         * イベントリスナー追加
         */
        addEventListener: function(type, listener) {
            if (this._listeners[type] === undefined) {
                this._listeners[type] = [];
            }
            
<span id='tm-event-EventDispatcher-property-dispatchEvent'>            this._listeners[type].push(listener);
</span>            return this;
        },
        
        /**
         * @property
         * イベント起動
         */
        dispatchEvent: function(e) {
            e.target = this;
            var oldEventName = 'on' + e.type;
            if (this[oldEventName]) this[oldEventName](e);
            
            var listeners = this._listeners[e.type];
            if (listeners) {
                for (var i=0,len=listeners.length; i&lt;len; ++i) {
<span id='tm-event-EventDispatcher-property-hasEventListener'>                    listeners[i].call(this, e);
</span>                }
            }
        },
        
        /**
         * @property
         * 登録されたイベントがあるかをチェック
         */
        hasEventListener: function(type) {
<span id='tm-event-EventDispatcher-property-removeEventListener'>            if (this._listeners[type] === undefined &amp;&amp; !this[&quot;on&quot; + type]) return false;
</span>            return true;
        },
        
        /**
         * @property
         * リスナーを削除
         */
        removeEventListener: function(type, listener) {
            var listeners = this._listeners[type];
<span id='tm-event-EventDispatcher-property-clearEventListener'>            var index = listeners.indexOf(listener);
</span>            if (index != -1) {
                listeners.splice(index,1);
            }
            return this;
        },
        
        /**
         * @property
         * リスナーを全てクリア
         */
        clearEventListener: function(type) {
            this._listeners[type] = [];
            return this;
        },
    });
    
})();
</pre>
</body>
</html>
